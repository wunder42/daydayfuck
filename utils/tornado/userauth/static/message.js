// Generated by CoffeeScript 1.6.3
(function() {
  var $, updater;

  $ = jQuery;

  updater = {
    socket: null,
    start: function() {
      var url;
      url = 'ws://' + location.host + '/message';
      updater.socket = new WebSocket(url);
      return updater.socket.onmessage = function(e) {
        console.log(e);
        return updater.showMessage(JSON.parse(e.data));
      };
    },
    showMessage: function(msg) {
      console.log(msg);
      if (msg.type === 1) {
        console.log('1');
        return $(".online-num").text(parseInt($(".online-num").text()) + msg.addNum);
      } else if (msg.type === 2) {
        console.log('2');
        return $(".sysinfo").text(msg.msg);
      }
    }
  };

  $(function() {
    console.log('message in...');
    $("#send").click(function(e) {
      return updater.socket.send(JSON.stringify({
        type: 1
      }));
    });
    return updater.start();
  });

}).call(this);
